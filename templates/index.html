{% extends "_layout.html" %}

{% block title %}Text Generator | AI Chat & Content{% endblock %}

{% block content %}
<div class="main-container chat-page-container">
    <div id="history-panel" class="history-panel">
        <h2>History <span onclick="toggleHistory()" class="close-history">✕</span></h2>
        <div id="history-box">
        </div>
        <button class="icon-btn delete-btn" onclick="deleteHistory()">🗑️ Clear History</button>
    </div>

    <div class="chat-container">
        <div class="header-bar">
            <h1>⚡ Thinkr AI Chat</h1>
            <div class="control-group">
                <label for="voice-select">Voice:</label>
                <select id="voice-select" title="Select AI Voice"></select>
                <button class="icon-btn history-btn mobile-only" onclick="toggleHistory()">📚</button>
            </div>
        </div>

        <div id="chat-box">
            <div class="message ai-msg">
                <span>Hello! I'm Thinkr, an ultra-fast AI made by Rishabh Kumar. Ask me anything! 🚀</span>
                <span class="speaker-icon" onclick="speakMessage(this)">🔊</span>
            </div>
        </div>

        <div class="search-bar">
            <input type="file" id="fileInput" accept="image/*" style="display: none;">
            
            <button class="icon-btn file-btn" onclick="triggerFileInput()" title="Upload Image">📎</button>
            
            <input type="text" id="userInput" placeholder="💡 Ask Thinkr anything (or upload an image)..." onkeydown="if(event.key==='Enter'){sendMessage();}">
            
            <button class="icon-btn send-btn" onclick="sendMessage()">
                <img src="{{ url_for('static', filename='th.webp') }}" alt="Send" class="button-icon">
            </button>
            
            <button class="icon-btn stop-btn hidden" onclick="stopResponding()">⏹️</button>
            
            <button class="icon-btn mic-btn" onclick="startListening()">
                <img src="{{ url_for('static', filename='OIP (3).webp') }}" alt="Mic" class="button-icon">
            </button>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='script.js') }}"></script>
{% endblock %}
